<!DOCTYPE html>
<html>
          <!-- The html, css, js goes below here -->
          <head>
            <title>Paint By Number</title>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.14.0/cdn/themes/light.css" />
            <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.14.0/cdn/shoelace-autoloader.js"></script>
            <link
              rel="stylesheet"
              media="(prefers-color-scheme:light)"
              href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.14.0/cdn/themes/light.css"
            />
            <link
              rel="stylesheet"
              media="(prefers-color-scheme:dark)"
              href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.14.0/cdn/themes/dark.css"
              onload="document.documentElement.classList.add('sl-theme-dark');"
            />
    
            <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    
            <style>
                
                button {
                    background-color: white;
                    color           : navy;
                    border          : none;
                    padding         : 20px 22px;
                    text-align      : center;
                    font-size       : 20px;
                    margin          : 10px 20px;
                    opacity         : 0.8;
                    transition      : 0.3s;
                    display         : center;
                    cursor          : pointer;
                    width           : 50%;
                }

                h1 {
                    text-align          : center;
                }
                .dropbox {
                    border: 2px dashed #ccc;
                    padding: 20px;
                    text-align: center;
                    cursor: pointer;
                }

                .dropbox p {
                    font-size: 16px;
                    margin: 0;
                }

                input[type="file"] {
                    display: none;
                }
            </style>

            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link rel="stylesheet" href="styles.css">
            <title>File Dropbox</title>
          </head>
    <body><center>
    <h1>Paint By Number</h1>

    
    <div class="dropbox">
        <p>Drag and drop files here</p>
        <input type="file" id="fileInput">
    </div>
    <script src="script.js"></script>

    <form  id="uploadForm" >
        <input type="file" id="fileInput" name="fileInput"/>
        <input type="submit" value="Upload"/>
        <div id="imgPreview"></div>
    </form>
    <script>
        // script.js
    const dropbox = document.querySelector('.dropbox');
    const fileInput = document.getElementById('fileInput');

    dropbox.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropbox.classList.add('highlight');
    });

    dropbox.addEventListener('dragleave', () => {
    dropbox.classList.remove('highlight');
    });

    dropbox.addEventListener('drop', (e) => {
    e.preventDefault();
    dropbox.classList.remove('highlight');
    const file = e.dataTransfer.files[0];
    handleFileUpload(file);
    });

    fileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    handleFileUpload(file);
    });

    function handleFileUpload(file) {
    // Implement your logic to handle the uploaded file here
    console.log('File uploaded:', file.name);
    }

      // show a preview of the image
      document.getElementById('fileInput').addEventListener('change', function(e) {
        var file = e.target.files[0];
        var reader = new FileReader();
        reader.onload = function(e) {
          var img = new Image();
          img.src = e.target.result;
          img.width = 200;
          document.getElementById('imgPreview').innerHTML = '';
          document.getElementById('imgPreview').appendChild(img);
        };
        reader.readAsDataURL(file);
      });

       // send some data to 127.0.0.1:5500 using a POST request
         document.getElementById('uploadForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var form = e.target;
            var formData = new FormData(form);
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/image', true);
            xhr.onload = function() {
                if (xhr.status === 200) {
                    console.log('success', xhr.responseText);
                    // returns base64 string replace with imgPreview and make it display the image
                    // decode the base64 string and display the image
                    var img = new Image();
                    img.src = 'data:image/png;base64,' + xhr.responseText;
                    img.width = 200;
                    document.getElementById('imgPreview').innerHTML = '';
                    document.getElementById('imgPreview').appendChild(img);
                }
            };
            xhr.send(formData);
        });
 
    </script>
    </center></body>
</html>
